# æ¨¡å— 00ï¼šæ–‡ä»¶æ‰«æä¸åˆ†å—ç­–ç•¥

[â† è¿”å›ä¸»æ–‡æ¡£](../AI_AGENT_è§†è§‰è¿˜åŸ_SOP_3.1_ä¸»æ–‡æ¡£.md)

---

## ğŸ¯ ç›®æ ‡

åœ¨å¼€å§‹å¤„ç†å‰è¯„ä¼°æ–‡ä»¶å¤§å°ï¼Œåˆ¶å®šåˆé€‚çš„å¤„ç†ç­–ç•¥ï¼Œé¿å…å› æ–‡ä»¶è¿‡å¤§å¯¼è‡´å†…å®¹æˆªæ–­ã€‚

---

## ğŸ“‹ æ‰§è¡Œæ­¥éª¤

### 1. æ–‡ä»¶å¤§å°æ£€æŸ¥

**æ£€æŸ¥é¡¹**ï¼š
- ä¸»HTMLæ–‡ä»¶å¤§å°ï¼ˆ>10KBéœ€è¦å…³æ³¨ï¼‰
- ä¸»CSSæ–‡ä»¶å¤§å°ï¼ˆ>50KBéœ€è¦å…³æ³¨ï¼‰
- èµ„æºä½ç½®ï¼ˆCDN/æœ¬åœ°ï¼‰
- â­ **HTMLæ–‡ä»¶å¤§å°è¯„ä¼°**ï¼ˆå†³å®šå¤„ç†ç­–ç•¥ï¼‰

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°
ls -lh index.html
ls -lh *.css

# æˆ–ä½¿ç”¨Python
python3 -c "import os; print(f'HTML: {os.path.getsize(\"index.html\")/1024:.1f}KB')"
```

---

### 2. Tokenæ•°ä¼°ç®—

**ä¼°ç®—å…¬å¼**ï¼š
```
1KB â‰ˆ 250 tokens
100KB â‰ˆ 25,000 tokens
400KB â‰ˆ 100,000 tokens
```

**å†³ç­–è§„åˆ™**ï¼š
```
å¦‚æœ HTML < 100KBï¼š
  â†’ å¯ä»¥ä¸€æ¬¡æ€§å¤„ç†
  â†’ ä½¿ç”¨å¸¸è§„æµç¨‹

å¦‚æœ HTML 100KB - 300KBï¼š
  â†’ é‡‡ç”¨åˆ†æ®µå¤„ç†
  â†’ éœ€è¦åˆ†æˆ 3-5 æ®µ

å¦‚æœ HTML > 300KBï¼š
  â†’ å¿…é¡»é‡‡ç”¨å¤šè½®å¤„ç†
  â†’ éœ€è¦åˆ†æˆ 6+ æ®µ
  â†’ å»ºè®®ä½¿ç”¨å¢é‡ç”Ÿæˆç­–ç•¥
```

---

### 3. Sectionç»Ÿè®¡

**ç›®æ ‡**ï¼šå¿«é€Ÿç»Ÿè®¡æ€»sectionæ•°

**æ–¹æ³•Aï¼šä½¿ç”¨grep**
```bash
grep -c "<section" index.html
```

**æ–¹æ³•Bï¼šä½¿ç”¨Pythonè„šæœ¬**
```python
import re

with open('index.html', 'r', encoding='utf-8') as f:
    content = f.read()
    sections = re.findall(r'<section', content)
    print(f"æ‰¾åˆ° {len(sections)} ä¸ªsection")
```

---

### 4. åˆ¶å®šå¤„ç†ç­–ç•¥

æ ¹æ®æ–‡ä»¶å¤§å°å’Œsectionæ•°é‡ï¼Œé€‰æ‹©åˆé€‚çš„ç­–ç•¥ï¼š

#### ç­–ç•¥Aï¼šä¸€æ¬¡æ€§å¤„ç†
**é€‚ç”¨**ï¼šHTML < 100KBï¼Œsection < 10ä¸ª

**æ­¥éª¤**ï¼š
1. ç›´æ¥è¯»å–å®Œæ•´HTML
2. æŒ‰ç…§é˜¶æ®µ1-8é¡ºåºå¤„ç†
3. ä¸€æ¬¡æ€§ç”Ÿæˆå®Œæ•´é¡¹ç›®

---

#### ç­–ç•¥Bï¼šåˆ†æ®µå¤„ç†ï¼ˆæ¨èï¼‰
**é€‚ç”¨**ï¼šHTML 100KB-300KBï¼Œsection 10-20ä¸ª

**æ­¥éª¤**ï¼š
1. ç”¨Pythonè„šæœ¬å®šä½æ‰€æœ‰sectionçš„è¡Œå·
2. ç”Ÿæˆsection_map.json
3. é€æ®µè¯»å–å’Œå¤„ç†
4. æœ€ååˆå¹¶

**Pythonè„šæœ¬ç¤ºä¾‹**ï¼š
```python
import re

def find_sections(html_file):
    with open(html_file, 'r', encoding='utf-8') as f:
        lines = f.readlines()
    
    sections = []
    in_section = False
    start_line = 0
    section_depth = 0
    
    for i, line in enumerate(lines, 1):
        # æ£€æµ‹sectionå¼€å§‹æ ‡ç­¾
        if '<section' in line:
            if not in_section:
                start_line = i
                in_section = True
                section_depth = 1
            else:
                section_depth += 1
        
        # æ£€æµ‹sectionç»“æŸæ ‡ç­¾
        elif '</section>' in line and in_section:
            section_depth -= 1
            if section_depth == 0:
                sections.append({
                    'index': len(sections) + 1,
                    'start': start_line,
                    'end': i,
                    'size_kb': (i - start_line) * 0.1  # ç²—ç•¥ä¼°ç®—
                })
                in_section = False
    
    return sections

# æ‰§è¡Œ
sections = find_sections('index.html')
print(f"æ‰¾åˆ° {len(sections)} ä¸ªsection")
for s in sections:
    print(f"Section {s['index']}: è¡Œ {s['start']}-{s['end']} (çº¦{s['size_kb']:.1f}KB)")

# ä¿å­˜åˆ°JSON
import json
with open('section_map.json', 'w', encoding='utf-8') as f:
    json.dump(sections, f, indent=2, ensure_ascii=False)
```

---

#### ç­–ç•¥Cï¼šå¢é‡ç”Ÿæˆ
**é€‚ç”¨**ï¼šHTML > 300KBï¼Œsection > 20ä¸ª

**æ­¥éª¤**ï¼š
```
Round 1: 
  - æ­å»ºé¡¹ç›®æ¡†æ¶
  - ç”Ÿæˆ Navigation + Footer
  - ç”Ÿæˆ Hero section (Section 1)

Round 2:
  - æ·»åŠ  Section 2-5
  - æå–å¯¹åº”æ•°æ®

Round 3:
  - æ·»åŠ  Section 6-10
  - æå–å¯¹åº”æ•°æ®

Round 4:
  - æ·»åŠ  Section 11-15
  - æå–å¯¹åº”æ•°æ®

Round 5:
  - å®Œå–„ç»†èŠ‚
  - éªŒè¯å®Œæ•´æ€§
```

---

### 5. CSSæ ¼å¼æ£€æŸ¥

**é‡è¦**ï¼šæ£€æŸ¥CSSæ–‡ä»¶æ˜¯å¦è¢«å‹ç¼©

**æ£€æŸ¥æ–¹æ³•**ï¼š
```bash
# æŸ¥çœ‹æ–‡ä»¶å¤´éƒ¨
head -c 100 style.css

# å¦‚æœçœ‹åˆ°ä¹±ç ï¼Œå¯èƒ½æ˜¯Brotliå‹ç¼©
file style.css
```

**å¦‚æœæ˜¯å‹ç¼©æ ¼å¼**ï¼š
```bash
# éœ€è¦å…ˆè§£å‹
# æ–¹æ³•1: ä½¿ç”¨åœ¨çº¿å·¥å…·
# æ–¹æ³•2: ä½¿ç”¨brotliå‘½ä»¤è¡Œå·¥å…·
brotli -d style.css.br

# æ–¹æ³•3: ä½¿ç”¨Python
python3 -c "import brotli; open('style.css', 'wb').write(brotli.decompress(open('style.css.br', 'rb').read()))"
```

---

## ğŸ“¤ è¾“å‡ºæ ¼å¼

### æ–‡ä»¶è¯„ä¼°æŠ¥å‘Š

```json
{
  "stage": "é˜¶æ®µ0ï¼šæ–‡ä»¶æ‰«æ",
  "timestamp": "2026-01-26T10:00:00",
  "main_html": {
    "path": "index.html",
    "size": "446KB",
    "size_bytes": 456704,
    "estimated_tokens": 114176,
    "processing_strategy": "multi-pass"
  },
  "main_css": {
    "path": "webflow.css",
    "size": "180KB",
    "format": "uncompressed",
    "selectors_count": "500+"
  },
  "structure_analysis": {
    "total_sections": 15,
    "estimated_components": 25,
    "sections_map_generated": true
  },
  "processing_plan": {
    "strategy": "åˆ†æ®µå¤„ç†",
    "segments_needed": 8,
    "estimated_rounds": 4,
    "reason": "HTMLæ–‡ä»¶è¿‡å¤§ï¼Œéœ€è¦åˆ†æ®µå¤„ç†ä»¥é¿å…tokené™åˆ¶"
  }
}
```

---

## âœ… æ£€æŸ¥ç‚¹

å®Œæˆæœ¬é˜¶æ®µåï¼Œç¡®è®¤ï¼š

- [ ] HTMLæ–‡ä»¶å¤§å°å·²è¯„ä¼°
- [ ] Tokenæ•°å·²ä¼°ç®—
- [ ] Sectionæ€»æ•°å·²ç»Ÿè®¡
- [ ] å¤„ç†ç­–ç•¥å·²ç¡®å®š
- [ ] å¦‚éœ€åˆ†æ®µï¼Œsection_map.jsonå·²ç”Ÿæˆ
- [ ] CSSæ ¼å¼å·²æ£€æŸ¥ï¼ˆå¦‚å‹ç¼©å·²è§£å‹ï¼‰
- [ ] æ–‡ä»¶è¯„ä¼°æŠ¥å‘Šå·²è¾“å‡º

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: HTMLæ–‡ä»¶å¤ªå¤§ï¼Œè¯»å–ä¼šè¶…æ—¶æ€ä¹ˆåŠï¼Ÿ
**A**: ä¸è¦ä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨åˆ†æ®µè¯»å–ï¼š
```python
# åªè¯»å–æŒ‡å®šè¡ŒèŒƒå›´
def read_lines(file, start, end):
    with open(file, 'r', encoding='utf-8') as f:
        lines = f.readlines()[start-1:end]
    return ''.join(lines)
```

### Q2: å¦‚ä½•ç¡®å®šæ¯æ®µåº”è¯¥å¤šå¤§ï¼Ÿ
**A**: æ¯æ®µå»ºè®®æ§åˆ¶åœ¨ 15-20KBï¼ˆçº¦4000-5000 tokensï¼‰ï¼Œè¿™æ ·å¯ä»¥ç•™å‡ºè¶³å¤Ÿçš„ä¸Šä¸‹æ–‡ç©ºé—´ã€‚

### Q3: CSSæ–‡ä»¶å‹ç¼©äº†ï¼Œä½†è§£å‹å¤±è´¥ï¼Ÿ
**A**: 
1. ç¡®è®¤å‹ç¼©æ ¼å¼ï¼ˆBrotli/Gzipï¼‰
2. å¦‚æœæ˜¯Webflowå¯¼å‡ºï¼Œå¯èƒ½éœ€è¦ä»CDNé‡æ–°ä¸‹è½½æœªå‹ç¼©ç‰ˆæœ¬
3. æœ€åæƒ…å†µï¼šæ‰‹åŠ¨å¤åˆ¶CSSå†…å®¹åˆ°æ–°æ–‡ä»¶

---

[â†’ ä¸‹ä¸€æ­¥ï¼šæ¨¡å—01 - ç»“æ„åˆ†æ](./01_ç»“æ„åˆ†æ.md)
